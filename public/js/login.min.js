$(document).ready((function(){var baseUrl=location.origin;function notification(){$.ajax({url:baseUrl+"/hostel-tool/actions/notification-active.php",method:"get"}).done((function(res){var response=JSON.parse(res);let content="",data=response.details;if(void 0!==data){let lengthArr=data.length;lengthArr>0&&($(".notification-count").removeClass("d-none"),$(".notification-count").text(lengthArr))}else $(".notification-count").addClass("d-none"),$(".notification-count").text(0);200==response.statusCode?$.each(data,(function(ind,val){content+=`\n                    <a href ='${baseUrl}/hostel-tool/admin/account-active.php'>\n                        <li class="hover position-relative m-2">\n                            <div class="active-req p-3 d-flex justify-content-between align-items-center">\n                                <div class="text">\n                                    <p class="mb-0">New request to reactived #${val} this account</p>\n                                </div>\n                                <div class="close-icon cp ms-2">\n                                    <i class="fas fa-times"></i>\n                                </div>\n                            </div>\n                            <span class="vertical-line line-red" data-id=${val}></span>\n                        </li>\n                    </a>\n                    `})):content+=`<li class="hover position-relative m-2">\n                                <div class="no-data p-3">\n                                    <p class="mb-0">${response.message}</p>\n                                </div>\n                            </li>`,$(".notification-content ul").html(content)})).fail((function(res){toastr.error("Something went wrong, Internal server error.")}))}function viewDeactiveAccount(){$.ajax({url:baseUrl+"/hostel-tool/actions/view-deactive-account.php",method:"get"}).done((function(res){let response=JSON.parse(res),content="";if(200==response.statusCode){let data=response.details;$.each(data,(function(ind,val){content+=`\n                    <tr>\n                        <td>${""!=val.id&&null!=val.id?val.id:"--"}</td>\n                        <td>${""!=val.first_name&&null!=val.first_name?val.first_name:"--"}</td>\n                        <td>${""!=val.last_name&&null!=val.last_name?val.last_name:"--"}</td>\n                        <td>${""!=val.email&&null!=val.email?val.email:"--"}</td>\n                        <td>${""!=val.contact_no&&null!=val.contact_no?val.contact_no:"--"}</td>\n                        <td>${""!=val.is_active&&null!=val.is_active?'<span class="badge-red">In active</span>':"--"}</td>\n                        <td>\n                            <div class='d-flex align-items-center mt-1'>\n                                <div class='approve cp' data-id='${val.id}'>\n                                    <i class="fas text-success fa-check-circle"></i>\n                                </div>\n                            </div>\n                        </td>\n                    </tr>\n                    `}))}else content+=`\n                <tr>\n                    <td colspan = '7' class='text-center'>${response.message}</td>\n                </tr>\n                `;$("#account-active tbody").html(content)})).fail((function(res){}))}function Emptyvalidation(){let error=0;return $(".validation").each((function(){let _self=$(this),required_field=_self.attr("data-required-field");""==_self.val()?(_self.addClass("is-invalid"),_self.parent().find(".err-mge").text(required_field+" field is required."),error=1):(_self.removeClass("is-invalid").addClass("is-valid"),_self.parent().find(".err-mge").text(""),error=0)})),error}function passwordValidation(){let error=0,password_rejex=/^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#\$%\^&\*])(?=.{8,})/;return $(".passwordValidation").each((function(){let _self=$(this),required_field=_self.attr("data-required-field");""==_self.val()?(_self.removeClass("is-valid").addClass("is-invalid"),_self.parent().find(".err-mge").text(required_field+" field is required."),error=1):password_rejex.test(_self.val())?(_self.removeClass("is-invalid").addClass("is-valid"),_self.parent().find(".err-mge").text(""),error=0):(_self.removeClass("is-valid").addClass("is-invalid"),_self.parent().find(".err-mge").text(required_field+" is invalid."),error=1)})),error}function Emailvalidation(){let error=0,email_rejex=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return $(".emailvalidation").each((function(){let _self=$(this),required_field=_self.attr("data-required-field");""==_self.val()?(_self.removeClass("is-valid").addClass("is-invalid"),_self.parent().find(".err-mge").text(required_field+" field is required."),error=1):email_rejex.test(_self.val())?(_self.removeClass("is-invalid").addClass("is-valid"),_self.parent().find(".err-mge").text(""),error=0):(_self.removeClass("is-valid").addClass("is-invalid"),_self.parent().find(".err-mge").text(required_field+" is invalid."),error=1)})),error}function validation(){let error=0,email_rejex=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,password_rejex=/^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#\$%\^&\*])(?=.{8,})/;var phone_rejex=/^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/;return $(".validation").each((function(){let _self=$(this),required_field=_self.attr("data-required-field"),type=_self.attr("data-type");if("text"==type)""==_self.val()?(_self.addClass("is-invalid"),_self.parent().find(".err-mge").text(required_field+" field is required."),error=1):(_self.removeClass("is-invalid").addClass("is-valid"),_self.parent().find(".err-mge").text(""),error=0);else if("email"==type)""==_self.val()?(_self.removeClass("is-valid").addClass("is-invalid"),_self.parent().find(".err-mge").text(required_field+" field is required."),error=1):email_rejex.test(_self.val())?(_self.removeClass("is-invalid").addClass("is-valid"),_self.parent().find(".err-mge").text(""),error=0):(_self.removeClass("is-valid").addClass("is-invalid"),_self.parent().find(".err-mge").text(required_field+" is invalid."),error=1);else if("password"==type)""==_self.val()?(_self.removeClass("is-valid").addClass("is-invalid"),_self.parent().find(".err-mge").text(required_field+" field is required."),error=1):password_rejex.test(_self.val())?(_self.removeClass("is-invalid").addClass("is-valid"),_self.parent().find(".err-mge").text(""),error=0):(_self.removeClass("is-valid").addClass("is-invalid"),_self.parent().find(".err-mge").text(required_field+" is invalid."),error=1);else if("cpassword"==type){let password=$(".password").val();""==_self.val()?(_self.removeClass("is-valid").addClass("is-invalid"),_self.parent().find(".err-mge").text(required_field+" field is required."),error=1):password!=_self.val()?(_self.removeClass("is-valid").addClass("is-invalid"),_self.parent().find(".err-mge").text("The password confirmation does not match"),error=1):(_self.removeClass("is-invalid").addClass("is-valid"),_self.parent().find(".err-mge").text(""),error=0)}else"select"==type?""==_self.val()?(_self.addClass("is-invalid"),_self.parent().find(".err-mge").text(required_field+" field is required."),error=1):(_self.removeClass("is-invalid").addClass("is-valid"),_self.parent().find(".err-mge").text(""),error=0):"phone"==type&&(""==_self.val()?(_self.removeClass("is-valid").addClass("is-invalid"),_self.parent().find(".err-mge").text(required_field+" field is required."),error=1):phone_rejex.test(_self.val())?(_self.removeClass("is-invalid").addClass("is-valid"),_self.parent().find(".err-mge").text(""),error=0):(_self.removeClass("is-valid").addClass("is-invalid"),_self.parent().find(".err-mge").text(required_field+" is invalid."),error=1))})),error}function resetForm(){$(".validation").val(""),$(".validation").removeClass("is-valid")}$("#login-btn").on("click",(function(e){e.preventDefault();let error=0;if(error+=Emptyvalidation(),0==error){let email=$(".email").val(),password=$(".password").val();$.ajax({url:"actions/auth.act.php",method:"post",data:{email:email,password:password}}).done((function(res){var response=JSON.parse(res);200==response.statusCode?(toastr.success(response.message),resetForm(),"super admin"==response.role||"admin"==response.role?window.location.href=baseUrl+"/hostel-tool/admin/dashboard.php":window.location.href=baseUrl+"/hostel-tool/user/dashboard.php"):403==response.statusCode?(toastr.error(response.message),setTimeout(()=>{window.location.href=baseUrl+"/hostel-tool/active-account.php"},2e3)):toastr.error(response.message)})).fail((function(res){toastr.error("Something went wrong, Internal server error.")}))}})),$("#register").on("click",(function(e){e.preventDefault();let error=0;if(error+=validation(),0==error){let form_data={first_name:$(".first_name").val(),last_name:$(".last_name").val(),email:$(".email").val(),gender:$(".gender").val(),contant_no:$(".contant_no").val(),password:$(".password").val(),cpassword:$(".cpassword").val()};$.ajax({url:"actions/register.php",method:"post",data:form_data}).done((function(res){var response=JSON.parse(res);200==response.statusCode?(toastr.success(response.message),resetForm(),window.location.href=baseUrl+"/hostel-tool/index.php"):toastr.error(response.message)})).fail((function(res){}))}})),$(".logout").on("click",(function(e){e.preventDefault(),$.ajax({url:baseUrl+"/hostel-tool/actions/logout.php",method:"get"}).done((function(res){var response;200==JSON.parse(res).statusCode&&(window.location.href=baseUrl+"/hostel-tool/index.php")})).fail((function(res){}))})),$("#reactive-btn").on("click",(function(e){e.preventDefault();let error=0;if(error+=Emailvalidation(),0==error){let email=$(".email").val();$.ajax({url:baseUrl+"/hostel-tool/actions/active-account.php",method:"post",data:{email:email}}).done((function(res){var response=JSON.parse(res);200==response.statusCode?(toastr.success(response.message),$(".email").val("")):toastr.error(response.message)})).fail((function(res){toastr.error("Something went wrong, Internal server error.")}))}})),notification(),viewDeactiveAccount(),$("body").on("click",".approve",(function(){let id=$(this).attr("data-id");$.ajax({url:baseUrl+"/hostel-tool/helpers/mail.php",method:"post",data:{id:id}}).done((function(res){let response=JSON.parse(res);200==response.statusCode?(toastr.success(response.message),viewDeactiveAccount()):toastr.error(response.message)})).fail((function(res){toastr.error("Something is wrong, Please try again later.")}))}))}));